#!/bin/bash

SED=$1
EBV=$2

BASE=`basename $SED .sed`

awk '{if ($1>1200 && $1<6300) {k=2.659*(-2.156+1.509/($1/1E4)-0.198/($1/1E4)**2+0.011/($1/1E4)**3)+4.05; print $1,$2*10**(-0.4*k*'$EBV')}; if ($1<22000 && $1>=6300) {k=2.659*(-1.857+1.040/($1/1E4))+4.05; print $1,$2*10**(-0.4*k*'$EBV')}; if ($1<=1200) {k=2.659*(-2.156+1.509/(1200/1E4)-0.198/(1200/1E4)**2+0.011/(1200/1E4)**3)+4.05; print $1,$2*10**(-0.4*k*'$EBV')}; if ($1>=22000) {k=2.659*(-1.857+1.040/(22000/1E4))+4.05; print $1,$2*10**(-0.4*k*'$EBV')};}' $SED > ${BASE}_Calzetti_EBV$EBV.sed
